# 恋爱占有欲指数测试网站 - 开发说明

## 项目概述

这是一个基于纯前端技术开发的恋爱占有欲指数测试网站，实现了完整的测试流程、RPI指数计算和报告生成功能。

## 项目结构

```
lovetest20251104/
├── index.html              # 首页
├── consent.html            # 知情同意页面
├── info.html               # 个人信息填写页面
├── test.html               # 答题页面
├── report.html             # 报告页面
├── rpi-detail.html         # RPI计算方法说明页面
├── questionBank.json       # 题库数据（JSON格式）
├── css/
│   ├── style.css          # 主样式文件
│   ├── consent.css        # 知情同意页面样式
│   ├── info.css           # 个人信息页面样式
│   ├── test.css           # 答题页面样式
│   └── report.css         # 报告页面样式
├── js/
│   ├── storage.js         # 本地存储管理模块
│   ├── config.js          # 配置管理模块
│   ├── utils.js           # 工具函数模块
│   ├── main.js            # 首页逻辑
│   ├── test.js            # 答题页面逻辑
│   └── report.js          # 报告页面逻辑
├── parse_questions.py      # 题库解析脚本（Python）
└── README.md              # 需求文档
```

## 功能特性

### 1. 测试流程
- ✅ 首页引导和测试类型选择
- ✅ 授权码验证
- ✅ 知情同意确认
- ✅ 个人信息填写
- ✅ 分页答题（40题）
- ✅ 进度保存和恢复
- ✅ RPI指数计算
- ✅ 报告生成和查看

### 2. 双视角测试
- ✅ 给自己测（第一人称视角）
- ✅ 为恋人测（观察者视角）
- 每个视角包含40道题目，覆盖4个维度

### 3. RPI计算算法
- ✅ 原始分计算
- ✅ z分数标准化
- ✅ 等权重合成
- ✅ 百分位数转换
- ✅ 基于10000+样本常模数据

### 4. 报告功能
- ✅ RPI指数总览
- ✅ 维度拆解分析
- ✅ 可视化图表（柱状图、雷达图）
- ✅ 专家建议
- ✅ 沟通技巧指南

### 5. 本地存储
- ✅ 授权码信息存储
- ✅ 答题进度自动保存
- ✅ 测试记录管理
- ✅ 配置缓存（1小时有效期）

### 6. 测试记录管理
- ✅ 记录列表展示
- ✅ 按视角、时间、RPI范围筛选
- ✅ 记录删除功能
- ✅ 报告查看功能

## 使用方法

### 1. 本地运行

由于使用了ES6模块和fetch API，建议使用本地服务器运行：

```bash
# 使用Python
python -m http.server 8000

# 使用Node.js (需要安装http-server)
npx http-server

# 使用VS Code的Live Server插件
```

然后在浏览器访问 `http://localhost:8000`

### 2. 部署

将项目文件上传到支持静态文件的Web服务器即可。

## 技术实现

### 前端技术
- HTML5
- CSS3（响应式设计）
- JavaScript (ES6+)
- Canvas API（图表绘制）
- LocalStorage API（本地存储）

### 核心算法

#### RPI计算流程：
1. 计算各维度原始分（10-50分）
2. 基于常模数据计算z分数
3. 等权重合成四个维度z分数
4. 通过CDF函数转换为0-100分的RPI指数

#### 常模数据（config.js）：
```javascript
normData: {
    dimensions: {
        '控制欲望': { mean: 25, std: 8 },
        '嫉妒强度': { mean: 22, std: 7 },
        '情感依赖': { mean: 28, std: 9 },
        '关系不安': { mean: 24, std: 8 }
    }
}
```

## 配置说明

### 授权码配置
目前授权码验证逻辑在 `utils.js` 的 `checkAuthCodeStatus` 函数中。实际项目中应该调用后端API进行验证。

### 常模数据配置
常模数据在 `js/config.js` 中配置，可以根据实际样本数据更新。

### 获取授权码链接配置
在 `js/config.js` 的 `getAuthLink` 函数中配置，需要连接后端API获取。

## 注意事项

1. **授权码验证**：当前实现为模拟验证，实际项目中需要连接后端API
2. **题库数据**：题库数据存储在 `questionBank.json`，从docx文件解析生成
3. **数据存储**：所有数据存储在浏览器LocalStorage，清除缓存会丢失数据
4. **浏览器兼容性**：支持现代浏览器（Chrome 80+、Safari 13+、Edge 80+、Firefox 75+）
5. **PDF/图片导出**：导出功能已预留接口，需要集成相应库（如jsPDF、html2canvas）

## 待完善功能

1. PDF导出功能（需要集成jsPDF）
2. 图片导出功能（需要集成html2canvas）
3. 后端API集成（授权码验证、配置管理）
4. 管理员后台（需要后端支持）
5. 更完善的错误处理
6. 数据校验和异常处理优化

## 开发建议

1. 使用现代浏览器开发者工具进行调试
2. 检查LocalStorage中的数据结构和内容
3. 测试不同屏幕尺寸的响应式效果
4. 验证RPI计算结果的准确性
5. 测试答题流程的完整性和数据保存

## 联系与支持

如有问题或建议，请通过商务合作按钮获取联系方式。

